%{(require '[ngontinh.libpath :as l]
           '[sodahead.render :as r]
           '[ngontinh.util.truyen :as truyen]
)}


<!DOCTYPE html>
<html lang="en">
<head>

  %{(def path (params :path))
    (def num (params :num))
    (def docchuong (peek (truyen/getChap (str "SELECT chap.truyen, chap.title, chap.date_added, chap.num, truyen.chap as sochuong, truyen.title as titletruyen FROM chap INNER JOIN truyen ON chap.truyen=truyen.path where truyen ='" path "' and num =" num ""))))

    nil}


<meta charset="utf-8">
    <meta charset="utf-8">
   <title>%(docchuong :titletruyen) - #%(docchuong :num): %(docchuong :title) | Trang Ngôn Tình</title>  
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <link rel="icon" href="%(l/paths :icon)" type="image/gif" sizes="16x16">
    <!-- Bootstrap -->  
    <link href="%(l/paths :bootcss)" rel="stylesheet" media="screen" type="text/css"> 
    <link rel="stylesheet" href="%(l/paths :bootstheme)">
    <link href="%(l/paths :docscss)" rel="stylesheet">  
    <link href="%(l/paths :bootsresponsive)" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="%(l/paths :stylesheet2)">
    <style>
        body{
          background-image:url("%(l/paths :bgr)"); 
        }  
        @font-face {
          font-family: 'Glyphicons Halflings';
          src:  url('%(l/paths :font1)');
          src:  url('%(l/paths :font1)?#iefix') format('embedded-opentype'), 
                url('%(l/paths :font2)') format('woff'), 
                url('%(l/paths :font3)') format('truetype'), 
                url('%(l/paths :font4)#glyphicons_halflingsregular') format('svg');
        }

    </style>
</head>

<!--================================================== -->
  <body class="maubody1">
<div class="le">  

   %include {"resources/util/pageheader.html"}

   <!--================================================== -->

  <div class="row-fluid">   

    <div class="span9">
    <div id="mautrang" class="whiteBgr">


                <div class="row-fluid" id="bcrumb">

                  <span  id="template1" style="display:none">
                  <ol class="breadcrumb">
                      <li><a href="%l/hostPath">Home</a></li>
                      <li><a href="%(str l/hostPath "englishnovel/pgnumber/1")">English Novel</a></li>
                      <li><a href="%(docchuong :linktruyen)">%(docchuong :titletruyen)</a></li>
                      <li class="active">Chương %(docchuong :num)</li>
                  </ol>
                  </span>
                  
                </div>
                <br>       

                <form class="form-inline" style="float:right;">
                  <div class="btn-group form-group">
                    <button type="button" id="doimau" class="btn btn-default btn-sm text-center">Change Background</button>
                    <button type="button" id="alignleft" class="btn btn-sm btn-default"><span class="glyphicon glyphicon-align-left"></span></button>
                    <button type="button" id="aligncenter" class="btn btn-sm btn-default"><span class="glyphicon glyphicon-align-center"></span></button>
                    <button type="button" id="alignright" class="btn btn-sm btn-default"><span class="glyphicon glyphicon-align-right"></span></button>
                    <button type="button" id="alignjustify" class="btn btn-sm btn-default"><span class="glyphicon glyphicon-align-justify"></span>
                    </button>
                  </div>
                  <div class="form-group">  
                    <select class="form-control" id="coChu" style="height:30px;">
                          <option> Size </option>
                          <option value="18" id="muoitam">18 </option>
                          <option value="19" id="muoichin">19 </option>
                          <option value="20" id="haimuoi">20 </option>
                          <option value="21" id="haimot">21 </option>
                          <option value="22" id="haihai">22 </option>  
                          <option value="23" id="haiba">23 </option>
                          <option value="24" id="haitu">24 </option>         
                          <option value="25" id="hailam">25 </option>     
                          <option value="26" id="haisau">26 </option>                   
                    </select>                  
                  </div>
                </form>
                <br>
                <hr>

                
    %{(def disable (if (= (compare (docchuong :num) 1) 0) "disabled" ""))
    (def disable2 (if (= (compare (docchuong :num) (docchuong :sochuong)) 0) "disabled" ""))
    nil}
                
      <div class="row-fluid">  
        <ul class="pager">
          <a href="%(str (docchuong :linktruyen) "/" (- (docchuong :num) 1))"><button class="btn btn-success btn-sm truoc %disable">&larr; Back </button></a>
          <li><button class="btn btn-warning btn-sm">Go To</button>
              <input type="text" class="denchuong" id="denchuongmoi" placeholder="Chapter:"></li>
          <a href="%(str (docchuong :linktruyen) "/" (+ (docchuong :num) 1))"><button class="btn btn-success btn-sm sau %disable2"> Next &rarr;</button></a>
        </ul>        
      </div>    



      %{ (def raw-content (slurp (str "resources/Truyen/" path "/" num ".txt")))
      (def content (clojure.string/replace (clojure.string/trim (subs raw-content (.indexOf raw-content "\n"))) #"\n" "<br>"))
      nil
      }


      <div class="row-fluid" id="doctruyen">
      <div id = "template2" style ="display:none">
        <a href="%(docchuong :linktruyen)"><h2 class="orange text-center"><strong>%(docchuong :titletruyen)</strong></h2></a>
        <h3 class="blue text-center">Chap %(docchuong :num): %(docchuong :title)</h3>
        <div class="span1">
        </div>
        
        <div class="span9">
              <br><br>
              <p class="bodytruyen">%content</p>

        </div><!--span9-->
      </div> <!--row-fluid-->

      <br>
      <br>

      <div class="row-fluid">  
        <ul class="pager">
          <a href="%(str (docchuong :linktruyen) "/" (- (docchuong :num) 1))"><button class="btn btn-success btn-sm truoc %disable">&larr; Back</button></a>
          <li><button class="btn btn-warning btn-sm">Go To</button>
              <input type="text" class="denchuong" id="denchuongmoi" placeholder="Chapter:"></li>
          <a href="%(str (docchuong :linktruyen) "/" (+ (docchuong :num) 1))"><button class="btn btn-success btn-sm sau %disable2"> Next &rarr;</button></a>
        </ul> 
      </div> 
        
      

    </div><!--whiteBgr-->

   <br>
   <br>

     <div class="row-fluid whiteBgr">    
            <div class="span12">
              <h5 class="white highlight">Gửi Phản Hồi</h5>    
              <br>
             <form class="form-horizontal">
                  <div class="form-group">
                      <label for="inputEmail" class="control-label col-xs-2">Tên</label>
                      <div class="col-xs-4">
                          <input type="email" class="form-control" id="inputEmail" placeholder="Email">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="inputEmail" class="control-label col-xs-2">Chủ Đề</label>
                      <div class="col-xs-4">
                          <input type="email" class="form-control" id="chude" placeholder="Email">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="inputText" class="control-label col-xs-2">Cảm Nhận</label>
                      <div class="col-xs-10">                
                          <textarea class="form-control" id="myTextarea" rows="3" placeholder="Hãy thể hiện bản thân ở đây ..."></textarea>
                      </div>
                  </div>
                  <div class="form-group">
                      <div class="col-xs-offset-2 col-xs-10">
                          <button id="cmtbutton" type="button" class="btn btn-default">Gửi Cảm Nhận</button>                          
                      </div>
                  </div>
              </form>    

              <hr>              

              </br>
              <div class="media span9" id="try">
                
              </div>
           
            </div><!--Span12--> 

  </div><!--Row fluid-->

    </div><!--span9-->

  
    %(r/render "resources/util/tableofcontent.html" {:path path})

  </div><!--row-fluid-->
</div><!--Container fluid-->
 
</div><!--le-->

%include {"resources/util/footer.html"}

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
     <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
   <!-- <script src="bootstrap.js"></script> 
    <script src="bootstrap-example/js/bootstrap-transition.js"></script>
    <script src="bootstrap-example/js/bootstrap-alert.js"></script>
    <script src="bootstrap-example/js/bootstrap-modal.js"></script>
    <script src="bootstrap-example/js/bootstrap-dropdown.js"></script>
    <script src="bootstrap-example/js/bootstrap-scrollspy.js"></script>
    <script src="bootstrap-example/js/bootstrap-tab.js"></script>
    <script src="bootstrap-example/js/bootstrap-tooltip.js"></script>
    <script src="bootstrap-example/js/bootstrap-popover.js"></script>
    <script src="bootstrap-example/js/bootstrap-button.js"></script>-->
    <script src="[[((data :lib-path) :bootcollapsejs)]]"></script>
   <!--<script src="bootstrap-example/js/bootstrap-carousel.js"></script>
    <script src="bootstrap-example/js/bootstrap-typeahead.js"></script>  -->  

    <script>  

   $("#doimau").click(function(){
      $("#mautrang").toggleClass('whiteBgr blackBgr');
      $("body").toggleClass('maubody1 maubody2');  
    });

      $("#hiendangnhap").click(function(){
      $("#dangnhapblock").slideToggle();    
    });

       $("#cmtbutton").click(function(){
      var cmt = $("#myTextarea").val();
      var d = new Date();
      var tieude = $("#chude").val();
      var ten = $("#ten").val();
      var ngay = d.toLocaleDateString();
      var time = d.toLocaleTimeString();
      $("#try").prepend("<img class='media-object img-circle pull-left' src='image/7.jpg' width='64' height='64'>" +
                        "<div class='media-body'>"+
                          "<span class='heavyText orange'>" + ten + "</span>"+ "<br>"+
                          "<span class='media-heading'>" + tieude + "</span>"+
                          "<span class='bentrai2 text-muted small'>" +"Dang ngay "+ ngay +
                                                                      " luc "+ time +"</span>"+"<br>"+
                            cmt+"</div>"+"<hr>");    
    });


      $("#alignleft").click(function(){
      $(".bodytruyen").css('text-align', 'left');
    })
      $("#aligncenter").click(function(){
      $(".bodytruyen").css('text-align','center');
    })
      $("#alignright").click(function(){
      $(".bodytruyen").css('text-align', 'right');
    })
      $("#alignjustify").click(function(){
      $(".bodytruyen").css('text-align', 'justify');
    })

    
     $("#muoitam").click(function(){
          $(".bodytruyen").css('font-size', '18px');
    })
      $("#muoichin").click(function(){
          $(".bodytruyen").css('font-size', '19px');
    })
      $("#haimuoi").click(function(){
          $(".bodytruyen").css('font-size', '20px');
    })
      $("#haimot").click(function(){
          $(".bodytruyen").css('font-size', '21px');
    })
      $("#haihai").click(function(){
          $(".bodytruyen").css('font-size', '22px');
    })
      $("#haiba").click(function(){
          $(".bodytruyen").css('font-size', '23px');
    })
      $("#haitu").click(function(){
          $(".bodytruyen").css('font-size', '24px');
    })
      $("#hailam").click(function(){
          $(".bodytruyen").css('font-size', '25px');
    })
      $("#haisau").click(function(){
          $(".bodytruyen").css('font-size', '26px');
    })
    </script>
  </body>
</html>