%{(require '[ngontinh.libpath :as l]
           '[ngontinh.util.truyen :as truyen]
           '[clojure.java.io :as io]
)}


<h3><span class="label label-warning trangchutitle">Chương Mới Cập Nhật</h3>
      <div class="row-fluid">  
        <div class="lightblue2">          
            <div class="table-responsive">
              <table class="table table-striped table-hover ">                    
                <tbody>

          %{

                  (defn updatechap [linktruyen titletruyen linkchap num title]
                      (str " <tr class='text-muted'>
                              <td><a href='" linktruyen "' class='tentruyen'>" titletruyen "</a></td>
                              <td><a href='" linkchap "'>Chương " num ": " title "</a></td>                      
                            </tr>"))


            (def chuongmoi (truyen/getChap "SELECT chap.truyen, chap.title, chap.date_added, chap.num, truyen.title as titletruyen FROM chap INNER JOIN truyen ON chap.truyen=truyen.path ORDER BY date_added desc limit 10"))


                      (apply str (for [x chuongmoi] 
                                  (updatechap (x :linktruyen) (x :titletruyen) (x :linkchap) (x :num) (x :title))))

           }
                 
                </tbody>
              </table>
            </div><!--Table-responsive-->   
        </div><!--lightBlue-->  
      </div><!--row-fluid-->