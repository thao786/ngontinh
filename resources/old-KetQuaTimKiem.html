%{(require '[ngontinh.libpath :as l]
           '[sodahead.render :as r]
           '[ngontinh.util.truyen :as truyen]
           '[clojure.java.io :as io]
)}


<!DOCTYPE html>
<html lang="en">
<head>
  %(def keyword (params :tukhoa))
    <meta charset="utf-8">
    <title>Kết Quả Tìm Kiếm từ khóa "%keyword" | Trang Ngôn Tình</title>  
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <link rel="icon" href="%(l/paths :icon)" type="image/gif" sizes="16x16">
    <!-- Bootstrap -->  
    <link href="%(l/paths :bootcss)" rel="stylesheet" media="screen" type="text/css"> 
    <link rel="stylesheet" href="%(l/paths :bootstheme)">
    <link href="%(l/paths :docscss)" rel="stylesheet">  
    <link href="%(l/paths :bootsresponsive)" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="%(l/paths :stylesheet)">
    <style>
        body{
          background-image:url("%(l/paths :bgr)");
        }  
        @font-face {
          font-family: 'Glyphicons Halflings';
          src:  url('%(l/paths :font1)');
          src:  url('%(l/paths :font1)?#iefix') format('embedded-opentype'), 
                url('%(l/paths :font2)') format('woff'), 
                url('%(l/paths :font3)') format('truetype'), 
                url('%(l/paths :font4)#glyphicons_halflingsregular') format('svg');
        }
        i{
          color: grey;
        }
    </style>
</head>

<!--================================================== -->
 <body class="maubody1"> 
<div class="le">  

  %include {"util/pageheader"}


<!--================================================== -->


  <div class="row-fluid">     
      <div class="span3">              
        
          %include {"util/truyenngaunhien.html"}

        </div>

           <!--================================================== -->

      <div class="span9">            
            <div class="whiteBgr">
                <div class="row-fluid">
                  <ol class="breadcrumb">
                      <li><a href="%l/hostPath">Home</a></li>
                      <li class="active">Kết Quả Tìm Kiếm</li>
                                            
                    </ol>
                </div>
                <br>

                <h4 class="highlight white">Kết Quả Tìm Kiếm</h4> 

                <br>               
                      <div class="form-inline well well-sm">
                        <label class="cachnhaura">Tên Truyện</label>
                      <form action="search" method="get">
                        <select name ="contain" class="form-control cachnhaura">
                          <option>chứa từ</option>
                          <option>bắt đầu bằng</option>
                          <option>kết thúc bằng</option>                      
                        </select>
                        <input type="text" name="input" class="form-control cachnhaura">
                        <button type="submit" class="btn btn-default cachnhaura">Tìm</button> 
                      </form> 
                      </div>                    

                <br>
                <hr>                

                <h3 class="text-muted" id="tukhoa">Tìm kiếm với từ khóa: <i class="green">%keyword</i>
                                                              
                </h3>      
                <br>

                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                          <tr>
                            <th>Giới Thiệu</th>  
                            <th><a href="%((params :sapxep) :theotitle)">Tên Truyện<b class="caret"></b></a></th>
                            <th><a href="%((params :sapxep) :theochap)">Số chương<b class="caret"></b></a></th>
                            <th><a href="%((params :sapxep) :theogenre)">Thể Loại<b class="caret"></b></a></th>
                            <th><a href="%((params :sapxep) :theoview)">Lượt Xem<b class="caret"></b></a></th>
                          </tr>
                        </thead>
                        <tbody>           
                            
                %{(defn listtruyen [linktruyen linkanh title alternate author genre shortoverview chap view state   searchauthor searchgenre]
                     (str "<tr class=''>
                  <td><span class='dropdown hidden-xs'>
                          <button class='dropdown-toggle btn btn-xs' params-toggle='dropdown'>Giới Thiệu<b class='caret'></b></button>
                              <div class='dropdown-menu VanAnDropdown'>
                                <div class='row-fluid'>
                                  <div class='span3'>
                                     <a href='" linktruyen "'><img src='" linkanh "' class='thumbnail img-responsive imgFloat' width='140' height='190'></a>
                                  </div>
                                  <div class='span9'> 
                                        <a href='" linktruyen "'><h3 class='green'><b>" title "</b></h3></a>
                                        <p><i>Tên Khác:</i> " alternate "
                                        <span style='visibility:hidden'>aaaaa</span><i>Tác Giả:</i> <a href='" searchauthor "'>" author "</a></p>                                        
                                        <p><i>Thể Loại:</i> <a href='" searchgenre "'>" genre "</a>
                                        <span style='visibility:hidden'>aaaaa</span><i>Tình Trạng:</i> " state "
                                        </p> 

                                        <hr>
                                        <p>" shortoverview "</p>        
                                  </div>
                                </div>            
                              </div>
                      </span>
                  </td>
                  <td><a href='" linktruyen "'>" title "</a></td>
                  <td>" chap "</td>
                  <td><a href='" searchgenre "'>" genre "</a></td>
                  <td>" view "</td>
                </tr>"))


              (def truyenresult (truyen/getTruyen (str "select * from truyen where title like '%" %keyword "%' or alternate like '%" %keyword "%' or author like '%" %keyword "%' or path like '%" %keyword "%' or genre like '%" %keyword "%' or source like '%" %keyword "%' or editor like '%" %keyword "%' or translator like '%" %keyword "%'"))) 

                        (apply str (for [x truyenresult] 
                            (listtruyen (x :linktruyen) (x :linkanh) (x :title) (x :alternate) (x :author) (x :genre) (x :shortoverview) (x :chap) (x :view) (x :state) (x :searchauthor) (x :searchgenre))))
          } 

                             
                        </tbody>
                    </table>
                </div><!--Table responsive-->

            </div><!--Whitebgr-->
      </div><!--Span9-269-->
    
    
  </div><!--Row fluid-137-->
</div><!--Container fluid-->

</div><!--le-->

%include {"util/footer.html"}

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

     <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
   <!-- <script src="bootstrap.js"></script> 
    <script src="bootstrap-example/js/bootstrap-transition.js"></script>
    <script src="bootstrap-example/js/bootstrap-alert.js"></script>
    <script src="bootstrap-example/js/bootstrap-modal.js"></script>
    <script src="bootstrap-example/js/bootstrap-dropdown.js"></script>
    <script src="bootstrap-example/js/bootstrap-scrollspy.js"></script>
    <script src="bootstrap-example/js/bootstrap-tab.js"></script>
    <script src="bootstrap-example/js/bootstrap-tooltip.js"></script>
    <script src="bootstrap-example/js/bootstrap-popover.js"></script>
    <script src="bootstrap-example/js/bootstrap-button.js"></script>-->
    <script src="%(l/paths :bootcollapsejs)"></script>
   <!--<script src="bootstrap-example/js/bootstrap-carousel.js"></script>
    <script src="bootstrap-example/js/bootstrap-typeahead.js"></script>  -->   
<script>  
  

   $("#hiendangnhap").click(function(){
    $("#dangnhapblock").slideToggle();    
    });

  $(document).ready(function(){
    $("tr:odd").addClass("success");
    $(".btn-xs:even").addClass("btn-default");
    $(".btn-xs:odd").addClass("btn-success");
    $(".list-group-item:even").addClass("list-group-item-warning");
    $(".list-group-item:odd").addClass("list-group-item-success");
  });
   
</script>

  </body>
</html>