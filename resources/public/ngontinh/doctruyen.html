%{require '[ngontinh.ngontinh.libpath :as l]
}

<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <title>%((param :titlepage) :title) - %((param :titlepage) :state) - %((param :titlepage) :author) | Trang Ngôn Tình</title>  
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <link rel="icon" href="%(l/paths :icon)" type="image/gif" sizes="16x16">
    <!-- Bootstrap -->  
    <link href="%(l/paths :bootcss)" rel="stylesheet" media="screen" type="text/css"> 
    <link rel="stylesheet" href="%(l/paths :bootstheme)">
    <link href="%(l/paths :docscss)" rel="stylesheet">  
    <link href="%(l/paths :bootsresponsive)" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="%(l/paths :stylesheet)">
    <style>
        body{
          background-image:url("%(l/paths :bgr)"); 
        }  
        @font-face {
          font-family: 'Glyphicons Halflings';
          src:  url('%(l/paths :font1)');
          src:  url('%(l/paths :font1)?#iefix') format('embedded-opentype'), 
                url('%(l/paths :font2)') format('woff'), 
                url('%(l/paths :font3)') format('truetype'), 
                url('%(l/paths :font4)#glyphicons_halflingsregular') format('svg');
        }
    </style>
</head>

<!--================================================== -->
 <body class="maubody1">
<div class="le">  

  %include {"resources/public/ngontinh/utility/pageheader.html"}


  <!--================================================== -->

<div class="container-fluid big-wrapper">  
  <div class="row-fluid">
      <div class="form-group form-inline col-xs-pull-2 bentrai2" style="float:right;">
          <input type="text" class="form-control" placeholder="Search ...">
          <button href="[[(param :tim)]]" type="submit" class="btn btn-default">Tìm</button>
          <button href="trangngontinh.com/advancedsearch" type="button" class="btn btn-success">Tìm kiếm nâng cao</button>
      </div>
  </div>    

  <div class="row-fluid">     
      <div class="span3">     

            <div class="hidden-xs">            
            <h3><span class="label label-custom">Truyện Cùng Thể Loại</span></h3>
            <div class="row-fluid sideBar"><!--Side Bar-->                       
                  <div class="list-group">

                    %{(defn sidebar1 [linktruyen linkanh title author genre]
                     (str "<a href='" linktruyen "' class='list-group-item'>
                          <div class='row-fluid'>
                            <div class='span5'><img src='" linkanh "' class='thumbnail img-responsive imgFloatsidebar list-group-item-text' width='90' height='120'></div>
                            <div class='span7'>
                              <h4 class='list-group-item-heading'>" title "</h4>               
                              <p class='blue small'>Tác Giả: " author "<br>
                                                    Thể Loại: " genre "</p>
                            </div>
                         </div>                                   
                        </a>"))

                        (apply str (for [x (param :sidebar1)] 
                              (sidebar1 (x :linktruyen) (x :linkanh) (x :title) (x :author) (x :genre))))
                    }


                </div><!--list group-->
            </div><!--sideBar-->
            </div><!--hiddenxs-->

            <br>
            <br>

            <div class="hidden-xs">            
            <h3><span class="label label-custom">Truyện Cùng Tác Giả</span></h3>
            <div class="row-fluid sideBar"><!--Side Bar-->                       
                  <div class="list-group">

                    %{(defn sidebar2 [linktruyen linkanh title author genre]
                     (str "<a href='" linktruyen "' class='list-group-item'>
                          <div class='row-fluid'>
                            <div class='span5'><img src='" linkanh "' class='thumbnail img-responsive imgFloatsidebar list-group-item-text' width='90' height='120'></div>
                            <div class='span7'>
                              <h4 class='list-group-item-heading'>" title "</h4>               
                              <p class='blue small'>Tác Giả: " author "<br>
                                                    Thể Loại: " genre "</p>
                            </div>
                         </div>                                   
                        </a>"))

                        (apply str (for [x (param :sidebar2)] 
                              (sidebar2 (x :linktruyen) (x :linkanh) (x :title) (x :author) (x :genre))))
                    }

                </div><!--list group-->
            </div><!--sideBar-->
            </div><!--hiddenxs-->
            
        </div>

           <!--================================================== -->

          <div class="span9">            
            <div class="whiteBgr">
                <div class="row-fluid">
                  <ol class="breadcrumb">
                      <li><a href="trangngontinh.com">Home</a></li>
                      <li><a href="trangngontinh.com/doctruyen">Đọc Truyện</a></li>
                      <li class="active">%((param :titlepage) :title)</li>
                    </ol>
                </div><br>                
                

            <div class="row-fluid">    
              <div class="span4">
                <img src="[[((param :truyeninfo) :linkanh)]]" class="thumbnail img-responsive" width="300" height="425">
              </div>
              <div class="span6">
                <a href="[[((param :truyeninfo) :linktruyen)]]"><h2 class="green"><b>%((param :truyeninfo) :title)</b></h2></a>
                <br>
                <p><i>Tên Khác</i>:  %((param :truyeninfo) :alternate)</p>
                <p><i>Tác Giả</i>:  <a href="[[((param :truyeninfo) :searchauthor)]]">%((param :truyeninfo) :author)</a></p>
                <p><i>Thể Loại</i>:  <a href="[[((param :truyeninfo) :searchgenre)]]">%((param :truyeninfo) :genre)</a></p>
                <p><i>Tình Trạng</i>:  <a href="[[((param :truyeninfo) :searchstate)]]">%((param :truyeninfo) :state)</a></p>
                <div class="minor-info">Nguồn: %((param :truyeninfo) :source)<br>
                                        Editor/Translator: %((param :truyeninfo) :person)<br>
                                        Lượt Xem: %((param :truyeninfo) :view)<br>
                                        Ngày Cập Nhập: %((param :truyeninfo) :date_added)</div>
              </div>
            </div>                             



            <div class="row-fluid">
              <div class="span7">
                <h5 class="orange"><b>Chương Mới Nhất</b></h5>    
                <div class="panel panel-success">                
                  <div class="panel-body">

                    %{(defn chuongmoi [linkchap chapnumber titlechap]
                        (str "<a href='" linkchap "'>Chương " chapnumber ": " titlechap "</a><br>"))

                        (apply str (for [x (param :chuongmoi)] 
                            (chuongmoi (x :linkchap) (x :chapnumber) (x :titlechap))))
                    }

                  </div>
                </div>  
              </div>          
            </div>

            <br>

              <!--<h4 class="white highlight">Giới Thiệu</h4>-->
              <h4 class="orange"><b>Giới Thiệu truyện </b><i class="green">%((param :titlepage) :title)</i></h4>
                <div class="well">
                  <p>%((param :gioithieu) :shortoverview)</p>
                  <div id="hiddenBlock" class="anHien">
                    <p>%((param :gioithieu) :remainoverview)</p>
                  </div>
                  <button id="xemThem" type="button" class="btn btn-default btn-sm btn-block 1">Xem Thêm</button>
                </div>    
            

            <br>

            
                <!--<h4 class="white highlight">Mục Lục</h4>-->
                <h4 class="orange"><b>Mục Lục truyện </b><i class="green">%((param :titlepage) :title)</i></h4>
                
                <div class="table-responsive">
                  <table class="table table-striped table-hover ">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Tên Chương</th>                        
                        <th>Ngày Đăng</th>                        
                      </tr>
                    </thead>
                    <tbody>

                      %{(defn mucluc [chapnumber linkchap titlechap date_added]
                         (str "<tr class=''>                  
                                  <td>" chapnumber "</td>
                                  <td><a href='" linkchap "'>" titlechap "</a></td>
                                  <td>" date_added "</td>
                               </tr>"))

                            (apply str (for [x (param :mucluc)] 
                                (mucluc (x :chapnumber) (x :linkchap) (x :titlechap) (x :date_added))))
                      }                               
                  
                    </tbody>
                  </table>
                </div>

          
          </div><!--Row-fluid-->

          <br>
          <br>
        

          <div class="row-fluid whiteBgr">    
            <div class="span12">
              <h5 class="white highlight">Gửi Phản Hồi</h5>    
              <br>
              <form class="form-horizontal">
                  <div class="form-group">
                      <label for="inputEmail" class="control-label col-xs-2">Tên</label>
                      <div class="col-xs-4">
                          <input type="email" class="form-control" id="inputEmail" placeholder="Email">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="inputEmail" class="control-label col-xs-2">Chủ Đề</label>
                      <div class="col-xs-4">
                          <input type="email" class="form-control" id="chude" placeholder="Email">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="inputText" class="control-label col-xs-2">Cảm Nhận</label>
                      <div class="col-xs-10">                
                          <textarea class="form-control" id="myTextarea" rows="3" placeholder="Hãy thể hiện bản thân ở đây ..."></textarea>
                      </div>
                  </div>
                  <div class="form-group">
                      <div class="col-xs-offset-2 col-xs-10">
                          <button id="cmtbutton" type="button" class="btn btn-default">Gửi Cảm Nhận</button>                          
                      </div>
                  </div>
              </form>    

              <hr>              

              </br>
              <div class="media span9" id="try">
                
              </div>
           
            </div><!--Span12-->
  
    </div><!--Span11-->
  </div><!--Row fluid-->


          </div><!--Span9-269-->
    
    
  </div><!--Row fluid-137-->
</div><!--Container fluid-->

</div><!--le-->

%include {"resources/public/ngontinh/utility/footer.html"}

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
   <!-- <script src="bootstrap.js"></script> 
    <script src="bootstrap-example/js/bootstrap-transition.js"></script>
    <script src="bootstrap-example/js/bootstrap-alert.js"></script>
    <script src="bootstrap-example/js/bootstrap-modal.js"></script>
    <script src="bootstrap-example/js/bootstrap-dropdown.js"></script>
    <script src="bootstrap-example/js/bootstrap-scrollspy.js"></script>
    <script src="bootstrap-example/js/bootstrap-tab.js"></script>
    <script src="bootstrap-example/js/bootstrap-tooltip.js"></script>
    <script src="bootstrap-example/js/bootstrap-popover.js"></script>
    <script src="bootstrap-example/js/bootstrap-button.js"></script>-->
    <script src="%(l/paths :bootcollapsejs)"></script>
   <!--<script src="bootstrap-example/js/bootstrap-carousel.js"></script>
    <script src="bootstrap-example/js/bootstrap-typeahead.js"></script>  -->    
<script>
  
  $("#xemThem").click(function(){
     $("#hiddenBlock").slideToggle();    
  });

  $("#hiendangnhap").click(function(){
        $("#dangnhapblock").slideToggle();    
  });

  $("#cmtbutton").click(function(){
      var cmt = $("#myTextarea").val();
      var d = new Date();
      var tieude = $("#chude").val();
      var ten = $("#ten").val();
      var ngay = d.toLocaleDateString();
      var time = d.toLocaleTimeString();
      $("#try").prepend("<img class='media-object img-circle pull-left' src='image/7.jpg' width='64' height='64'>" +
                        "<div class='media-body'>"+
                          "<span class='heavyText orange'>" + ten + "</span>"+ "<br>"+
                          "<span class='media-heading'>" + tieude + "</span>"+
                          "<span class='bentrai2 text-muted small'>" +"Dang ngay "+ ngay +
                                                                      " luc "+ time +"</span>"+"<br>"+
                            cmt+"</div>"+"<hr>");    
    });

  $(document).ready(function(){
    $(".list-group-item:even").addClass("list-group-item-warning");
    $(".list-group-item:odd").addClass("list-group-item-success");
    $("tr:odd").addClass("info");
  });

</script>

  </body>
</html>


(doseq [folder (.listFiles (File. "/resources/public/Truyen"))]
(let [image (File. (str (.getPath folder) "/cover.jpg"))]
(let [smimage (Files.copy(image, (str (.getPath folder) "/smcover.jpg")))]
)
))