%{(require '[ngontinh.libpath :as l]
           '[sodahead.render :as r]
           '[ngontinh.util.truyen :as truyen]
)}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
    <meta charset="utf-8">
    <title>Danh Sách Truyện | Trang Ngôn Tình</title>  
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <link rel="icon" href="%(l/paths :icon)" type="image/gif" sizes="16x16">
    <!-- Bootstrap -->  
    <link href="%(l/paths :bootcss)" rel="stylesheet" media="screen" type="text/css"> 
    <link rel="stylesheet" href="%(l/paths :bootstheme)">
    <link href="%(l/paths :docscss)" rel="stylesheet">  
    <link href="%(l/paths :bootsresponsive)" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="%(l/paths :stylesheet)">
    <style>
        body{
          background-image:url("%(l/paths :bgr)"); 
        }  
        @font-face {
          font-family: 'Glyphicons Halflings';
          src:  url('%(l/paths :font1)');
          src:  url('%(l/paths :font1)?#iefix') format('embedded-opentype'), 
                url('%(l/paths :font2)') format('woff'), 
                url('%(l/paths :font3)') format('truetype'), 
                url('%(l/paths :font4)#glyphicons_halflingsregular') format('svg');
        }
        i{
          color: grey;
        }
    </style>
</head>

<!--================================================== -->
   <body class="maubody1">
<div class="le">  

  %include {"resources/util/pageheader.html"}
    


          <!--================================================== -->
  <div class="row-fluid">
      

      <div class="span12 whiteBgr">

                <div class="row-fluid">
                  <ol class="breadcrumb">
                      <li><a href="#">Home</a></li>
                      <li class="active">Danh Sách Truyện</li>
                    </ol>
                </div><br>
                 
          <h4 class="sub-header white highlight" id="chuthich">Chú thích về thể loại</h4>
          <br>
          <div class="row-fluid">
            <div class="span3 chuThich">
                <img src="%(l/paths :cungdau)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/cungdau")"><h4><span class="label label-warning">Cung Đấu</span></h4></a>
                <span class="text-muted">Tranh đoạt chốn cung đình, thường là giữa các phi tử.</span>
            </div>
            <div class="span3">
                <img src="%(l/paths :dammy)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/dammy")"><h4><span class="label label-primary">Đam mỹ</h4></a>
                <span class="text-muted">Nam x Nam.</span>
            </div>
            <div class="span3 chuThich">
                <img src="%(l/paths :huyenhuyen)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/huyenhuyen")"><h4><span class="label label-warning">Huyền Huyễn</h4></a>
                <span class="text-muted">Truyện mang yếu tố kỳ ảo, có thần linh và các dị tương.</span>
            </div>
            <div class="span3">
                <img src="%(l/paths :nguoc)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/nguoc")"><h4><span class="label label-primary">Ngược</h4></a>
                <span class="text-muted">Nhân vật bị hành hạ về thể xác (Ngược thân) hoặc tinh thần (Ngược tâm).</span>
            </div>
          </div><!--Row-fluid-->
          <br>
          <div class="row-fluid">
            <div class="span3">
                <img src="%(l/paths :sac)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/cungdau"))"><h4><span class="label label-primary">Sắc</h4></a>
                <span class="text-muted">Cảnh 18+.</span>
            </div>
             <div class="span3 chuThich">
                <img src="%(l/paths :trongsinh)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/trongsinh")"><h4><span class="label label-warning">Trọng Sinh</h4></a>
                <span class="text-muted">Nhân vật được hồi sinh: Sống lại hoặc nhập vào cơ thể khác.</span>
            </div>
            <div class="span3">
                <img src="%(l/paths :vongdu)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/vongdu")"><h4><span class="label label-primary">Võng du</h4></a>
                <span class="text-muted">Truyện miêu tả song song giữa cuộc sống ảo trên mạng và ngoài đời thực của nhân vật.</span>
            </div>  
            <div class="span3 chuThich">
                <img src="%(l/paths :xuyenkhong)" class="thumbnail img-responsive img-circle" width="130" height="130">
                <a href="%(str l/hostPath "listtruyen/xuyenkhong")"><h4><span class="label label-warning">Xuyên Không</h4></a>
                <span class="text-muted">Nhân vật vượt qua thời gian trở về quá khứ hoặc đến tương lai.</span>
            </div>                      
          </div>

          <br>

          <a href="%(str l/hostPath "advancedsearch")"><h4 class="green">&raquo Xem thêm các thể loại truyện khác tại <span class="label label-success">Đây</span></h4></a>
         
          <br>
          <br>
          <br>

          <h1 class="header">Danh Sách <span class="green"><strong>Truyện Ngôn Tình</strong></span></h1>          
          <br>
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>Giới Thiệu</th>  
                  <th><a href="">Tên Truyện<b class="caret"></b></a></th>
                  <th><a href="">Tác giả<b class="caret">   </b></a></th>
                  <th><a href="">Thể loại<b class="caret">  </b></a></th>
                  <th><a href="">Lượt Xem<b class="caret"></b></a></th>
                  <th><a href="">Tình Trạng<b class="caret"></b></a></th>
                </tr>
              </thead>
              <tbody>

                %{

                (defn listtruyen [linktruyen linkanh title author path genre chap shortoverview view state alternate searchauthor searchgenre]
                     (str "<tr class=''>
                  <td><span class='dropdown hidden-xs'>
                          <button class='dropdown-toggle btn btn-sm' param-toggle='dropdown'>Giới Thiệu <b class='caret'></b></button>
                              <div class='dropdown-menu VanAnDropdown'>
                                <div class='row-fluid'>
                                  <div class='span3'>
                                     <a href='" linktruyen "'><img src='" linkanh "' class='thumbnail img-responsive imgFloat' width='140' height='190'></a>
                                  </div>
                                  <div class='span9'> 
                                        <a href='" linktruyen "'><h3 class='green'><b>" title "</b></h3></a>
                                        <p><i>Tên Khác:</i> " alternate "
                                        <span style='visibility:hidden'>aaaaa</span><i>Tác Giả:</i> <a href='" searchauthor "'>" author "</a></p>                                     
                                        <p><i>Thể loại:</i> <a href='" searchgenre "'>" genre "</a>
                                        <span style='visibility:hidden'>aaaaa</span><i>Số Chương:</i> " chap "
                                        </p>
                                        <hr>
                                        <p>" shortoverview "...</p>        
                                  </div>
                                </div>            
                              </div>
                      </span>
                  </td>
                  <td><a href='" linktruyen "'>" title "</a></td>
                  <td><a href='" searchauthor "'>" author "</a></td>
                  <td><a href='" searchgenre "'>" genre "</a></td>
                  <td>" view "</td>
                  <td>" state "</td>
                </tr>"))

            (def truyenall (truyen/getTruyen "SELECT * FROM truyen"
                 (let [firstoverview (truyen/first-overview)]
                 (assoc truyenall :shortoverview firstoverview))))

                        (apply str (for [x truyenall] 
                            (listtruyen (x :linktruyen) (x :linkanh) (x :title) (x :author) (x :path) (x :genre) (x :chap) (x :shortoverview) (x :view) (x :state) (x :alternate) (x :searchauthor) (x :searchgenre))))
             }             
     
            
              </tbody>
            </table>
          </div><!--Table responsive-->

          <br>
          <br>

    </div><!--Span10-->
  </div><!--Row fluid-->
</div><!--Container fluid-->
 
</div><!--le-->

%include {"resources/util/footer.html"}

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
   <!-- <script src="bootstrap.js"></script> 
    <script src="bootstrap-example/js/bootstrap-transition.js"></script>
    <script src="bootstrap-example/js/bootstrap-alert.js"></script>
    <script src="bootstrap-example/js/bootstrap-modal.js"></script>
    <script src="bootstrap-example/js/bootstrap-dropdown.js"></script>
    <script src="bootstrap-example/js/bootstrap-scrollspy.js"></script>
    <script src="bootstrap-example/js/bootstrap-tab.js"></script>
    <script src="bootstrap-example/js/bootstrap-tooltip.js"></script>
    <script src="bootstrap-example/js/bootstrap-popover.js"></script>
    <script src="bootstrap-example/js/bootstrap-button.js"></script>-->
    <script src="%(l/paths :bootcollapsejs)"></script>
   <!--<script src="bootstrap-example/js/bootstrap-carousel.js"></script>
    <script src="bootstrap-example/js/bootstrap-typeahead.js"></script>  --> 

<script>
    $("#hiendangnhap").click(function(){
    $("#dangnhapblock").slideToggle();    
    });

    $(document).ready(function(){
    $("tr:odd").addClass("info");
    $(".btn-sm:even").addClass("btn-default");
    $(".btn-sm:odd").addClass("btn-info");
  });
</script>
  </body>
</html>